% Copyright (c) 2013-2014 H. Turgut Uyar <uyar@itu.edu.tr>
%
% This work is licensed under a "Creative Commons
% Attribution-NonCommercial-ShareAlike 4.0 International License".
% For more information, please visit:
% https://creativecommons.org/licenses/by-nc-sa/4.0/

\documentclass[dvipsnames]{beamer}

\usepackage{ae}
\usepackage[scaled=0.88]{beramono}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\setbeamertemplate{navigation symbols}{}
\setbeamersize{text margin left=2em, text margin right=2em}

\usepackage{listings}
\lstset{basicstyle=\ttfamily, keywordstyle=\color{blue},
        showstringspaces=false, frame=ltrb}

\mode<presentation>
{
  \usetheme{default}
  \useinnertheme{rounded}
  \usecolortheme{seahorse}
  \setbeamercovered{transparent}
}

\title{Functional Programming}
\subtitle{Introduction}

\author{H. Turgut Uyar}
\date{2013-2014}

\AtBeginSubsection[]{
  \begin{frame}<beamer>
    \frametitle{Topics}
    \tableofcontents[currentsection,currentsubsection]
  \end{frame}
}

\theoremstyle{plain}

\pgfdeclareimage[height=1cm]{license}{../license}

\pgfdeclareimage[width=4cm]{turing}{turing}
\pgfdeclareimage[width=4cm]{church}{church}
\pgfdeclareimage[width=4cm]{backus}{backus}
\pgfdeclareimage[width=4cm]{mccarthy}{mccarthy}

\begin{document}

\begin{frame}
  \titlepage
\end{frame}

\begin{frame}
  \frametitle{License}

  \pgfuseimage{license}\hfill
  \copyright~2013-2014 H. Turgut Uyar

  \vfill
  \begin{footnotesize}
    You are free to:
    \begin{itemize}
      \itemsep0em
      \item Share -- copy and redistribute the material in any medium or format
      \item Adapt -- remix, transform, and build upon the material
    \end{itemize}

    Under the following terms:
    \begin{itemize}
      \itemsep0em
      \item Attribution -- You must give appropriate credit, provide a link to
        the license, and indicate if changes were made.

      \item NonCommercial -- You may not use the material for commercial
        purposes.

      \item ShareAlike -- If you remix, transform, or build upon the material,
        you must distribute your contributions under the same license as the
        original.
    \end{itemize}
  \end{footnotesize}

  \begin{small}
    For more information:\\
    \url{https://creativecommons.org/licenses/by-nc-sa/4.0/}

    \smallskip
    Read the full license:\\
    \url{https://creativecommons.org/licenses/by-nc-sa/4.0/legalcode}
  \end{small}
\end{frame}

\begin{frame}
  \frametitle{Topics}
  \tableofcontents
\end{frame}

\section{Programming Paradigms}

\lstset{language=python}

\subsection{Programming Languages}

\begin{frame}
  \frametitle{Programming Languages}

  \begin{itemize}
    \item \alert{syntax}: rules for writing a ``grammatically correct'' program
    \item how expressions, commands, declarations and other constructs\\
      must be arranged to make a well-formed program

    \pause
    \bigskip
    \item \alert{semantics}: how the program should be ``interpreted''
    \item how the program may be expected to behave\\
      when executed on a computer
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Idioms}

  \begin{itemize}
    \item knowing the syntax and semantics is not enough\\
      to master a programming language

    \medskip
    \item standard library
    \item other libraries
    \item tools: debugging, testing, profiling
    \item documenting
    \item style: code formatting, variable naming, \ldots

    \pause
    \medskip
    \item idioms: patterns for using language features
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Universality}

  \begin{itemize}
    \item \alert{universal}: capable of expressing any computation
    \item any language that supports iteration or recursion is universal

    \pause
    \bigskip
    \item Church-Turing thesis:\\
    \smallskip
    Any real-world computation can be translated\\
    into an equivalent computation involving a Turing machine.\\
    \medskip
    It can also be calculated using general recursive functions.\\
    \smallskip
    (\url{http://mathworld.wolfram.com/})
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Paradigms}

  \begin{itemize}
    \item \alert{paradigm}: approach to programming
    \item based on a set of principles or theory

    \medskip
    \item different paradigms: different ways of thinking
  \end{itemize}
\end{frame}

\subsection{Imperative Programming}

\begin{frame}
  \frametitle{Imperative Programming}

  \begin{columns}
    \column{.4\textwidth}
    \begin{center}
      \pgfuseimage{turing}\\
      Alan Turing (1912-1954)
    \end{center}

    \column{.6\textwidth}
    \begin{itemize}
      \item based on the Turing machine
      \item a program is a list of instructions\\
        for a von Neumann computer
      \item contents of memory constitute \alert{state}

      \pause
      \medskip
      \item statements update variables\\
        (\alert{mutation})
      \item assignment, control structures
      \item natural model of hardware
    \end{itemize}
  \end{columns}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Imperative Programming Example}

  \begin{itemize}
    \item greatest common divisor (Python)
  \end{itemize}

  \medskip
  \begin{columns}
    \column{.55\textwidth}
    \begin{lstlisting}
def gcd(x, y):
    r = 0
    while y > 0:
        r = x % y
        x = y
        y = r
    return x
    \end{lstlisting}

    \column{.4\textwidth}
    \begin{tabular}{|r|r|r|}\hline
   x &   y &   r\\\hline\hline
9702 & 945 &   0\\\hline
 945 & 252 & 252\\\hline
 252 & 189 & 189\\\hline
 189 &  63 &  63\\\hline
  63 &   0 &   0\\\hline
    \end{tabular}

    \medskip
    $\rightsquigarrow$ 63
  \end{columns}
\end{frame}

\begin{frame}
  \frametitle{Milestones in Imperative Programming Languages}

  \begin{columns}
    \column{.4\textwidth}
    \begin{center}
      \pgfuseimage{backus}\\
      John Backus (1924-2007)
    \end{center}

    \column{.55\textwidth}
    \begin{itemize}
      \item Fortran (1957)
      \item ALGOL (1960)
      \item C (1972)
      \item Ada (1983)
      \item Java (1995)
    \end{itemize}
  \end{columns}
\end{frame}

\subsection{Functional Programming}

\begin{frame}
  \frametitle{Functional Programming}

  \begin{columns}
    \column{.4\textwidth}
    \begin{center}
      \pgfuseimage{church}\\
      Alonzo Church (1903-1995)
    \end{center}

    \column{.6\textwidth}
    \begin{itemize}
      \item based on $\lambda$-calculus
      \item a program is a function application
      \item same inputs should produce\\
        same output

      \pause
      \medskip
      \item function also modifies context\\
        $\rightarrow$ \alert{side effect}
      \item avoid mutation
      \item higher order functions
    \end{itemize}
  \end{columns}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Functional Programming Example}

  \begin{itemize}
    \item greatest common divisor (Python)
  \end{itemize}

  \medskip
  \begin{columns}
    \column{.55\textwidth}
    \begin{lstlisting}
def gcd(x, y):
    if y == 0:
        return x
    else:
        return gcd(y, x % y)
    \end{lstlisting}

    \column{.4\textwidth}
    \lstinline{gcd(9702, 945)}\\
    $\rightsquigarrow$ \lstinline{gcd(945, 252)}\\
    \hspace{16pt}$\rightsquigarrow$ \lstinline{gcd(252, 189)}\\
    \hspace{32pt}$\rightsquigarrow$ \lstinline{gcd(189, 63)}\\
    \hspace{48pt}$\rightsquigarrow$ \lstinline{gcd(63, 0)}\\
    \hspace{64pt}$\rightsquigarrow$ \lstinline{63}\\
    \hspace{48pt}$\rightsquigarrow$ \lstinline{63}\\
    \hspace{32pt}$\rightsquigarrow$ \lstinline{63}\\
    \hspace{16pt}$\rightsquigarrow$ \lstinline{63}\\
    $\rightsquigarrow$ \lstinline{63}
  \end{columns}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Side Effects}

  \begin{itemize}
    \item sources of side effects: global variables
  \end{itemize}

  \begin{exampleblock}{example}
    \begin{lstlisting}
factor = 0

def multiples(n):
    global factor
    factor = factor + 1
    return factor * n
    \end{lstlisting}
  \end{exampleblock}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Side Effects}

  \begin{itemize}
    \item sources of side effects: function state, object state
  \end{itemize}

  \begin{exampleblock}{example}
    \begin{lstlisting}
class Multiplier:
    def __init__(self):
        self.factor = 0

    def multiples(self, n):
        self.factor = self.factor + 1
        return self.factor * n
    \end{lstlisting}
  \end{exampleblock}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Side Effects}

  \begin{itemize}
    \item sources of side effects: input/output
  \end{itemize}

  \begin{exampleblock}{example}
    \begin{lstlisting}
def read_byte(f):
    return f.read(1)
    \end{lstlisting}
  \end{exampleblock}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Side Effects}

  \begin{itemize}
    \item sources of side effects: randomness
  \end{itemize}

  \begin{exampleblock}{example}
    \begin{lstlisting}
import random

def get_random(n):
    return random.randrange(1, n + 1)
    \end{lstlisting}
  \end{exampleblock}
\end{frame}

\begin{frame}
  \frametitle{Problems with Side Effects}

  \begin{itemize}
    \item harder to reason about programs
    \item harder to test programs
    \item harder to parallelize programs

    \pause
    \bigskip
    \item could we write programs without relying on side effects?
    \item or, at least, could we constrain side effects?
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Milestones in Functional Programming Languages}

  \begin{columns}
    \column{.45\textwidth}
    \begin{center}
      \pgfuseimage{mccarthy}\\
      John McCarthy (1927-2011)
    \end{center}

    \column{.55\textwidth}
    \begin{itemize}
      \item Lisp (1957)
      \item ML (1973)
      \item Haskell (1990)
    \end{itemize}
  \end{columns}
\end{frame}

\begin{frame}
  \frametitle{Object Orientation}

  \begin{itemize}
    \item object orientation is about data abstraction
    \item type hierarchies

    \medskip
    \item these can be achieved in both paradigms
    \begin{itemize}
      \item Ocaml, F\#
      \item Scala
    \end{itemize}
    \item modern imperative languages have functional features
    \begin{itemize}
      \item Ruby, Python
      \item Java, C\#
    \end{itemize}

    \pause
    \medskip
    \item what makes a language functional or imperative?
    \begin{itemize}
      \item higher order functions
      \item most code written in functional style
    \end{itemize}
  \end{itemize}
\end{frame}

\section{Basic Concepts}

\subsection{Expressions}

\begin{frame}
  \frametitle{Expressions and Statements}

  \medskip
  \begin{itemize}
    \item \alert{expression}: a construct that will be evaluated
      to yield a value

    \medskip
    \item \alert{statement}: a construct that will be executed
      to update a variable
  \end{itemize}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Expression and Statement Example}

  \begin{itemize}
    \item conditional statement (Python)
    \smallskip
    \begin{lstlisting}
if x < 0:
    abs_x = -x
else:
    abs_x = x
    \end{lstlisting}

    \pause
    \medskip
    \item conditional expression (Python)
    \smallskip
    \begin{lstlisting}
abs_x = -x if x < 0 else x
    \end{lstlisting}

    \pause
    \medskip
    \item conditional expression (Haskell)
    \smallskip
    \begin{lstlisting}[language=haskell]
abs_x = if x < 0 then -x else x
    \end{lstlisting}
  \end{itemize}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Expression and Statement Example}

  \begin{itemize}
    \item bad:
    \smallskip
    \begin{lstlisting}
if age < 18:
    minor = True
else:
    minor = False
    \end{lstlisting}

    \pause
    \medskip
    \item better:
    \smallskip
    \begin{lstlisting}
minor = True if age < 18 else False
    \end{lstlisting}

    \pause
    \medskip
    \item much better:
    \smallskip
    \begin{lstlisting}
minor = age < 18
    \end{lstlisting}
  \end{itemize}
\end{frame}

\subsection{Definitions}

\lstset{language=haskell}

\begin{frame}[fragile]
  \frametitle{Definitions}

  \begin{itemize}
    \item \alert{binding}: an association between an identifier and an entity
    \item \alert{environment}: a set of bindings

    \pause
    \bigskip
    \item definitions in Haskell: name, type, expression
    \begin{lstlisting}
n :: t
n = e
    \end{lstlisting}

    \item redefining a variable is not allowed
  \end{itemize}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Definition Examples}

  \begin{lstlisting}
d :: Float      -- diameter of circle
d = 4.8

c :: Float      -- circumference of circle
c = 3.14159 * d

d = 15.62       -- multiple declarations
  \end{lstlisting}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Local Definitions}

  \begin{itemize}
    \item a \alert{local definition} can be used only within the expression\\
      where it is defined
  \end{itemize}

  \medskip
  \begin{columns}[b]
    \column{.5\textwidth}
    \begin{lstlisting}
n = e
  where
    n1 :: t1
    n1 = e1

    n2 :: t2
    n2 = e2
    ...
    \end{lstlisting}

    \pause
    \column{.45\textwidth}
    \begin{exampleblock}{example}
      \begin{lstlisting}
a :: Float
a = 3.14159 * r * r
  where
    r :: Float
    r = d / 2.0
      \end{lstlisting}
    \end{exampleblock}
  \end{columns}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Type Inference}

  \begin{itemize}
    \item Haskell can infer types (more on that later)
    \item we will leave out type declarations for data in local definitions
  \end{itemize}

  \begin{exampleblock}{example}
    \begin{lstlisting}
a :: Float
a = 3.14159 * r * r
  where r = d / 2.0
    \end{lstlisting}
  \end{exampleblock}
\end{frame}

\subsection{Functions}

\begin{frame}
  \frametitle{Functions}

  \begin{itemize}
    \item imperative: function body is a block
    \item special construct for sending back the result:
      \lstinline[language=python]{return}

    \pause
    \bigskip
    \item functional: function body is an expression
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Function Parameters}

  \begin{itemize}
    \item \alert{formal parameter}: an identifier through which a function\\
      accesses an argument
    \item declared at function definition

    \pause
    \medskip
    \item \alert{actual parameter}: an expression which yields an argument
    \item defined at function application
  \end{itemize}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Function Definitions}

  \begin{itemize}
    \item function definition in Haskell:
    \smallskip
    \begin{lstlisting}
n :: t1 -> t2 -> ... -> tk -> t
n x1 x2 ... xk = e
    \end{lstlisting}

    \pause
    \bigskip
    \item function application in Haskell:
    \smallskip
    \begin{lstlisting}
n e1 e2 ... ek
    \end{lstlisting}
  \end{itemize}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Function Examples}

  \begin{lstlisting}
sqr :: Integer -> Integer
sqr x = x * x

sqr 21    -- 441
sqr (2+5) -- 49

sumOfSquares :: Integer -> Integer -> Integer
sumOfSquares x y = sqr x + sqr y

sumOfSquares 3 4       -- 25
sumOfSquares 2 (sqr 3) -- 85
  \end{lstlisting}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Function Example}

  \begin{lstlisting}
sumOfCubes :: Integer -> Integer -> Integer
sumOfCubes x y = cube x + cube y
  where
    cube :: Integer -> Integer
    cube n = n * n * n
  \end{lstlisting}
\end{frame}

\section*{References}

\begin{frame}
  \frametitle{References}

  \begin{block}{Required Reading: Thompson}
    \begin{itemize}
      \item Chapter 1: \alert{Introducing functional programming}
      \item Chapter 2: \alert{Getting started with Haskell and GHCi}
    \end{itemize}
  \end{block}
\end{frame}

\end{document}
