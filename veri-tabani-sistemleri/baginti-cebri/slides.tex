% Copyright (c) 2002-2012
%       H. Turgut Uyar <uyar@itu.edu.tr>
%       Şule Gündüz Öğüdücü <sgunduz@itu.edu.tr>
%
% These notes are licensed using the
% "Creative Commons Attribution-NonCommercial-ShareAlike License".
% You are free to copy, distribute and transmit the work, and to adapt the work
% as long as you attribute the authors, do not use it for commercial purposes,
% and any derivative work is under the same or a similar license.
%
% Read the full legal code at:
% http://creativecommons.org/licenses/by-nc-sa/3.0/

\documentclass[dvipsnames]{beamer}

\usepackage{ae}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[turkish]{babel}
\setbeamertemplate{navigation symbols}{}
\usepackage[labelformat=empty, aboveskip=1pt, belowskip=1pt]{caption}

\usepackage{listings}
\lstdefinelanguage{TutorialD}[]{}{
  morekeywords={AND, AS, BASE, BOOL, CAST_AS_, CAST_AS_RATIONAL, CHAR,
                CONSTRAINT, DELETE, DIVIDEBY, DROP, INSERT, INTEGER, INTERSECT,
                JOIN, KEY, MINUS, OR, PER, POSSREP, RATIONAL, RELATION, RENAME,
                THE_, TUPLE, TYPE, UNION, UPDATE, VAR, WHERE}
}
\lstdefinelanguage{FullSQL}[]{SQL}{
  morekeywords={BINARY, BOOLEAN, CYCLE, FINAL, INCREMENT, IS, LARGE, MAXVALUE,
                MINVALUE, NO_ACTION, OBJECT, REFERENCES, RENAME, SEQUENCE,
                START, TO, TYPE, VACUUM}
}
\lstset{basicstyle=\ttfamily, keywordstyle=\color{blue}}

\mode<presentation>
{
  \usetheme{Warsaw}
  \usecolortheme[named=ForestGreen]{structure}
  \setbeamercovered{transparent}
}

\title{Veri Tabanı Sistemleri}
\subtitle{Bağıntı Cebri}

\author{H. Turgut Uyar \and Şule Öğüdücü}
\date{2002-2012}

\AtBeginSubsection[]{
  \begin{frame}<beamer>
    \frametitle{Konular}
    \tableofcontents[currentsection,currentsubsection]
  \end{frame}
}

\theoremstyle{definition}
\newtheorem{tanim}[theorem]{Tanım}

\theoremstyle{example}
\newtheorem{ornek}[theorem]{Örnek}

\theoremstyle{plain}

\pgfdeclareimage[width=2cm]{license}{../../license}

\begin{document}

\begin{frame}
  \titlepage
\end{frame}

\begin{frame}
  \frametitle{License}

  \pgfuseimage{license}\hfill
  \copyright 2002-2012 T. Uyar, Ş. Öğüdücü

  \vfill
  \begin{tiny}
    You are free:
    \begin{itemize}
      \item to Share -- to copy, distribute and transmit the work
      \item to Remix -- to adapt the work
    \end{itemize}

    Under the following conditions:
    \begin{itemize}
      \item Attribution -- You must attribute the work in the manner specified by
        the author or licensor (but not in any way that suggests that they
        endorse you or your use of the work).

      \item Noncommercial -- You may not use this work for commercial purposes.

      \item Share Alike -- If you alter, transform, or build upon this work, you
        may distribute the resulting work only under the same or similar license
        to this one.
    \end{itemize}
  \end{tiny}

  \vfill
  Legal code (the full license):\\
  \url{http://creativecommons.org/licenses/by-nc-sa/3.0/}
\end{frame}

\begin{frame}
  \frametitle{Konular}
  \tableofcontents
\end{frame}

\lstset{language=TutorialD}

\section{Bağıntı Cebri}

\subsection{Giriş}

\begin{frame}
  \frametitle{Kapalılık}

  \begin{tanim}
    \alert{kapalılık}: bütün işlemlerin girdileri de çıktıları da bağıntı
  \end{tanim}

  \pause
  \begin{itemize}
    \item bir işlemin çıktısı diğer bir işlemin girdisi olabilir
    \item içiçe işlemler yapılabilir
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Örnek Bağıntılar}

  \begin{ornek}[MOVIE]
    \begin{tiny}
    \begin{table}
      %\caption{MOVIE}
      \begin{tabular}{|r|l|r|r|r|r|}\hline
\underline{MOVIE\#} & TITLE           & YEAR & SCORE & VOTES & DIRECTOR\#\\[2pt]\hline\hline
   6 & Usual Suspects                 & 1995 &   8.7 & 35027 &        639\\\hline
  70 & Being John Malkovich           & 1999 &   8.3 & 13809 &       1485\\\hline
 107 & Batman \& Robin                & 1997 &   3.5 & 10577 &        105\\\hline
 110 & Sleepy Hollow                  & 1999 &   7.5 & 10514 &        148\\\hline
 112 & Three Kings                    & 1999 &   7.7 & 10319 &       1070\\\hline
 151 & Gattaca                        & 1997 &   7.4 &  8388 &       2020\\\hline
 213 & Blade                          & 1998 &   6.7 &  6885 &       2861\\\hline
 228 & Ed Wood                        & 1994 &   7.8 &  6587 &        148\\\hline
 251 & End of Days                    & 1999 &   5.5 &  6095 &        103\\\hline
 281 & Dangerous Liaisons             & 1988 &   7.7 &  5651 &        292\\\hline
 373 & Fear and Loathing in Las Vegas & 1998 &   6.5 &  4658 &         59\\\hline
 432 & Stigmata                       & 1999 &   6.1 &  4141 &       2557\\\hline
 433 & eXistenZ                       & 1999 &   6.9 &  4130 &         97\\\hline
 573 & Dead Man                       & 1995 &   7.4 &  3333 &        175\\\hline
1468 & Europa                         & 1991 &   7.6 &  1042 &        615\\\hline
1512 & Suspiria                       & 1977 &   7.1 &  1004 &       2259\\\hline
1539 & Cry-Baby                       & 1990 &   5.9 &   972 &        364\\\hline
    \end{tabular}
  \end{table}
  \end{tiny}
  \end{ornek}
\end{frame}

\begin{frame}
  \frametitle{Örnek Bağıntılar}

  \begin{ornek}[PERSON]
    \begin{columns}[b]
      \column{.5\textwidth}
      \begin{tiny}
      \begin{table}
        %\caption{PERSON}
        \begin{tabular}{|r|l|}\hline
\underline{PERSON\#} & NAME\\[2pt]\hline\hline
   9 & Arnold Schwarzenegger\\\hline
  26 & Johnny Depp          \\\hline
  59 & Terry Gilliam        \\\hline
  97 & David Cronenberg     \\\hline
 103 & Peter Hyams          \\\hline
 105 & Joel Schumacher      \\\hline
 138 & George Clooney       \\\hline
 148 & Tim Burton           \\\hline
 175 & Jim Jarmusch         \\\hline
 187 & Christina Ricci      \\\hline
 243 & Uma Thurman          \\\hline
 282 & Cameron Diaz         \\\hline
 292 & Stephen Frears       \\\hline
 302 & Benicio Del Toro     \\\hline
 308 & Gabriel Byrne        \\\hline
 350 & Jennifer Jason Leigh \\\hline
        \end{tabular}
      \end{table}
      \end{tiny}

      \column{.5\textwidth}
      \begin{tiny}
      \begin{table}
        \begin{tabular}{|r|l|}\hline
 364 & John Waters          \\\hline
 406 & Patricia Arquette    \\\hline
 503 & John Malkovich       \\\hline
 615 & Lars von Trier       \\\hline
 639 & Bryan Singer         \\\hline
 745 & Udo Kier             \\\hline
 793 & Jude Law             \\\hline
1070 & David O. Russell     \\\hline
1485 & Spike Jonze          \\\hline
1641 & Iggy Pop             \\\hline
2020 & Andrew Niccol        \\\hline
2259 & Dario Argento        \\\hline
2557 & Rupert Wainwright    \\\hline
2861 & Stephen Norrington   \\\hline
3578 & Traci Lords          \\\hline
        \end{tabular}
      \end{table}
      \end{tiny}
  \end{columns}
  \end{ornek}
\end{frame}

\begin{frame}
  \frametitle{Örnek Bağıntılar}

  \begin{ornek}[CASTING]
    \begin{columns}[b]
      \column{.3\textwidth}
      \begin{tiny}
      \begin{table}
        %\caption{CASTING}
        \begin{tabular}{|r|r|r|}\hline
\underline{MOVIE\#} & \underline{ACTOR\#} & ORD\\[2pt]\hline\hline
      6 &     308 &   2\\\hline
      6 &     302 &   3\\\hline
     70 &     282 &   2\\\hline
     70 &     503 &  14\\\hline
    107 &       9 &   1\\\hline
    107 &     138 &   2\\\hline
    107 &     243 &   4\\\hline
    110 &      26 &   1\\\hline
    110 &     187 &   2\\\hline
    112 &     138 &   1\\\hline
    112 &    1485 &   4\\\hline
    151 &     243 &   2\\\hline
    151 &     793 &   3\\\hline
    213 &     745 &   6\\\hline
        \end{tabular}
      \end{table}
      \end{tiny}

      \column{.2\textwidth}
      \begin{tiny}
      \begin{table}
        \begin{tabular}{|r|r|r|}\hline
    213 &    3578 &   8\\\hline
    228 &      26 &   1\\\hline
    228 &     406 &   4\\\hline
    251 &       9 &   1\\\hline
    251 &     308 &   2\\\hline
    251 &     745 &  10\\\hline
    281 &     243 &   7\\\hline
    281 &     503 &   2\\\hline
    373 &      26 &   1\\\hline
    373 &     187 &   6\\\hline
    373 &     282 &   8\\\hline
    373 &     302 &   2\\\hline
        \end{tabular}
      \end{table}
      \end{tiny}

      \column{.2\textwidth}
      \begin{tiny}
      \begin{table}
        \begin{tabular}{|r|r|r|}\hline
    432 &     308 &   2\\\hline
    432 &     406 &   1\\\hline
    433 &     350 &   1\\\hline
    433 &     793 &   2\\\hline
    573 &      26 &   1\\\hline
    573 &     308 &  12\\\hline
    573 &    1641 &   6\\\hline
   1468 &     745 &   3\\\hline
   1512 &     745 &   9\\\hline
   1539 &      26 &   1\\\hline
   1539 &    1641 &   5\\\hline
   1539 &    3578 &   7\\\hline
        \end{tabular}
      \end{table}
      \end{tiny}
    \end{columns}
  \end{ornek}
\end{frame}

\subsection{Seçme}

\begin{frame}[fragile]
  \frametitle{Seçme}

  \begin{tanim}
    \alert{seçme}: bir koşula uyan çokluları seçme
  \end{tanim}

  \pause
  \begin{block}{Komut}
    \begin{lstlisting}
relation WHERE condition
    \end{lstlisting}
  \end{block}

  \pause
  \begin{itemize}
    \item çıktı başlığı = girdi başlığı
  \end{itemize}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Seçme Örnekleri - 1}

  \begin{ornek}
    \begin{itemize}
      \item 10000'den fazla oy almış filmler (\texttt{S1})
    \end{itemize}

    \begin{lstlisting}
MOVIE WHERE (VOTES > 10000)
    \end{lstlisting}

    \pause
    \vspace{-10pt}
    \begin{tiny}
    \begin{table}
      \caption{S1}
      \begin{tabular}{|r|l|r|r|r|r|}\hline
\underline{MOVIE\#} & TITLE & YEAR & SCORE & VOTES & DIRECTOR\#\\[2pt]\hline\hline
  6 & Usual Suspects        & 1995 &   8.7 & 35027 &        639\\\hline
 70 & Being John Malkovich  & 1999 &   8.3 & 13809 &       1485\\\hline
107 & Batman \& Robin       & 1997 &   3.5 & 10577 &        105\\\hline
110 & Sleepy Hollow         & 1999 &   7.5 & 10514 &        148\\\hline
112 & Three Kings           & 1999 &   7.7 & 10319 &       1070\\\hline
      \end{tabular}
    \end{table}
    \end{tiny}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Seçme Örnekleri - 2}

  \begin{ornek}
    \begin{itemize}
      \item 1992'den önce çekilmiş, puanı 7.5'in üzerinde olan filmler
        (\texttt{S2})
    \end{itemize}

    \begin{lstlisting}
MOVIE WHERE ((YEAR < YEAR(1992))
         AND (SCORE > SCORE(7.5)))
    \end{lstlisting}

    \pause
    \vspace{-10pt}
    \begin{tiny}
    \begin{table}
      \caption{S2}
      \begin{tabular}{|r|l|r|r|r|r|}\hline
\underline{MOVIE\#} & TITLE & YEAR & SCORE & VOTES & DIRECTOR\#\\[2pt]\hline\hline
   281 & Dangerous Liaisons & 1988 &   7.7 &  5651 &        292\\\hline
  1468 & Europa             & 1991 &   7.6 &  1042 &        615\\\hline
      \end{tabular}
    \end{table}
    \end{tiny}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{İzdüşüm}

  \begin{tanim}
    \alert{izdüşüm}: bir nitelik kümesini seçme
  \end{tanim}

  \pause
  \begin{block}{Komut}
    \begin{lstlisting}
relation { attribute_name [, ...] }
    \end{lstlisting}
  \end{block}

  \pause
  \begin{itemize}
    \item çıktı başlığı = nitelik listesi
  \end{itemize}
\end{frame}

\begin{frame}[fragile]
  \frametitle{İzdüşüm Örnekleri - 1}

  \begin{ornek}
    \begin{itemize}
      \item bütün filmlerin başlıkları (\texttt{P1})
    \end{itemize}

    \begin{lstlisting}
MOVIE { TITLE }
    \end{lstlisting}

    \pause
    \vspace{-10pt}
    \begin{columns}[b]
      \column{.5\textwidth}
      \begin{tiny}
      \begin{table}
        \caption{P1}
        \begin{tabular}{|l|}\hline
\underline{TITLE}             \\[2pt]\hline\hline
Usual Suspects                \\\hline
Being John Malkovich          \\\hline
Batman \& Robin               \\\hline
Sleepy Hollow                 \\\hline
Three Kings                   \\\hline
Gattaca                       \\\hline
Blade                         \\\hline
Ed Wood                       \\\hline
End of Days                   \\\hline
        \end{tabular}
      \end{table}
      \end{tiny}

      \column{.5\textwidth}
      \begin{tiny}
      \begin{table}
        \begin{tabular}{|l|}\hline
Dangerous Liaisons            \\\hline
Fear and Loathing in Las Vegas\\\hline
Stigmata                      \\\hline
eXistenZ                      \\\hline
Dead Man                      \\\hline
Europa                        \\\hline
Suspiria                      \\\hline
Cry-Baby                      \\\hline
        \end{tabular}
      \end{table}
      \end{tiny}
    \end{columns}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{İzdüşüm Örnekleri - 2}

  \begin{ornek}
    \begin{itemize}
      \item bütün filmlerin başlıkları ve yılları (\texttt{P2})
    \end{itemize}

    \begin{lstlisting}
MOVIE { TITLE, YEAR }
    \end{lstlisting}

    \pause
    \vspace{-10pt}
    \begin{columns}[b]
      \column{.5\textwidth}
      \begin{tiny}
      \begin{table}
        \caption{P2}
        \begin{tabular}{|l|r|}\hline
\underline{TITLE}              & \underline{YEAR}\\[2pt]\hline\hline
Batman \& Robin                & 1997\\\hline
Being John Malkovich           & 1999\\\hline
Blade                          & 1998\\\hline
Cry-Baby                       & 1990\\\hline
Dangerous Liaisons             & 1988\\\hline
Dead Man                       & 1995\\\hline
Ed Wood                        & 1994\\\hline
End of Days                    & 1999\\\hline
Europa                         & 1991\\\hline
        \end{tabular}
      \end{table}
      \end{tiny}

      \column{.5\textwidth}
      \begin{tiny}
      \begin{table}
        \begin{tabular}{|l|r|}\hline
Fear and Loathing in Las Vegas & 1998\\\hline
Gattaca                        & 1997\\\hline
Sleepy Hollow                  & 1999\\\hline
Stigmata                       & 1999\\\hline
Suspiria                       & 1977\\\hline
Three Kings                    & 1999\\\hline
Usual Suspects                 & 1995\\\hline
eXistenZ                       & 1999\\\hline
        \end{tabular}
      \end{table}
      \end{tiny}
    \end{columns}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{İzdüşüm Örnekleri - 3}

  \begin{ornek}[bütün filmlerin yılları]
    \begin{itemize}
      \item bütün filmlerin yılları (\texttt{P3})
    \end{itemize}

    \begin{lstlisting}
MOVIE { YEAR }
    \end{lstlisting}

    \pause
    \vspace{-10pt}
    \begin{tiny}
    \begin{table}
      \caption{P3}
      \begin{tabular}{|r|}\hline
\underline{YEAR}\\[2pt]\hline\hline
            1995\\\hline
            1999\\\hline
            1997\\\hline
            1998\\\hline
            1994\\\hline
            1988\\\hline
            1991\\\hline
            1977\\\hline
            1990\\\hline
      \end{tabular}
    \end{table}
    \end{tiny}
  \end{ornek}
\end{frame}

\begin{frame}
  \frametitle{İzdüşüm Örnekleri - 4}

  \begin{ornek}
    \begin{itemize}
      \item 5000'den fazla oy almış, puanı 7.0'ın üzerinde olan filmlerin\\
        başlıkları (\texttt{P4})
    \end{itemize}

    \pause
    \begin{enumerate}
      \item 5000'den fazla oy almış, puanı 7.0'ın üzerinde olan filmler\\
        (\texttt{P4A})

      \pause
      \item \texttt{P4A}'daki başlıklar (\texttt{P4})
    \end{enumerate}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{İzdüşüm Örnekleri - 4}

  \begin{ornek}
    \begin{itemize}
      \item 5000'den fazla oy almış, puanı 7.0'ın üzerinde olan filmler\\
        (\texttt{P4A})
    \end{itemize}

    \begin{lstlisting}
MOVIE WHERE ((VOTES > 5000)
         AND (SCORE > SCORE(7.0)))
    \end{lstlisting}

    \pause
    \vspace{-10pt}
    \begin{tiny}
    \begin{table}
      \caption{P4A}
      \begin{tabular}{|r|l|r|r|r|r|}\hline
\underline{MOVIE\#} & TITLE & YEAR & SCORE & VOTES & DIRECTOR\#\\[2pt]\hline\hline
   6 & Usual Suspects       & 1995 &   8.7 & 35027 &        639\\\hline
  70 & Being John Malkovich & 1999 &   8.3 & 13809 &       1485\\\hline
 110 & Sleepy Hollow        & 1999 &   7.5 & 10514 &        148\\\hline
 112 & Three Kings          & 1999 &   7.7 & 10319 &       1070\\\hline
 151 & Gattaca              & 1997 &   7.4 &  8388 &       2020\\\hline
 228 & Ed Wood              & 1994 &   7.8 &  6587 &        148\\\hline
 281 & Dangerous Liaisons   & 1988 &   7.7 &  5651 &        292\\\hline
      \end{tabular}
    \end{table}
    \end{tiny}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{İzdüşüm Örnekleri - 4}

  \begin{ornek}
    \begin{itemize}
      \item \texttt{P4A}'daki başlıklar (\texttt{P4})
    \end{itemize}

    \begin{lstlisting}
P4A { TITLE }
    \end{lstlisting}

    \pause
    \vspace{-10pt}
    \begin{tiny}
    \begin{table}
      \caption{P4}
      \begin{tabular}{|l|}\hline
\underline{TITLE}   \\[2pt]\hline\hline
Being John Malkovich\\\hline
Dangerous Liaisons  \\\hline
Ed Wood             \\\hline
Gattaca             \\\hline
Sleepy Hollow       \\\hline
Three Kings         \\\hline
Usual Suspects      \\\hline
      \end{tabular}
    \end{table}
    \end{tiny}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{İzdüşüm Örnekleri - 4}

  \begin{ornek}
    \begin{itemize}
      \item 5000'den fazla oy almış, puanı 7.0'ın üzerinde olan filmlerin\\
        başlıkları (\texttt{P4})
    \end{itemize}

    \begin{lstlisting}
( MOVIE
    WHERE ((VOTES > 5000)
       AND (SCORE > SCORE(7.0))) )
  { TITLE }
    \end{lstlisting}
  \end{ornek}
\end{frame}

\subsection{Katma}

\begin{frame}[fragile]
  \frametitle{Katma}

  \begin{tanim}
    \alert{katma}: iki bağıntının çoklularını, bir ya da birden fazla niteliğin\\
      ortak değerleri üzerinden eşleştirme
  \end{tanim}

  \begin{itemize}
    \item iki bağıntının Kartezyen çarpımından,\\
      verilen nitelikler için aynı değeri taşıyan çokluları seçme
    \item eşleşen nitelikler çıktıda tekrarlanmaz

    \pause
    \item \alert{doğal katma}: aynı isimli niteliklerin ortak değerleri\\
      üzerinden eşleştirme
  \end{itemize}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Katma}

  \begin{block}{Komut}
    \begin{lstlisting}
relation1 JOIN relation2
    \end{lstlisting}
  \end{block}

  \pause
  \begin{itemize}
    \item çıktı başlığı = relation1 başlığı $\cup$ relation2 başlığı
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Katma Örnekleri - 1}

  \begin{ornek}
    \begin{itemize}
      \item bütün filmlerin başlıkları ve yönetmenlerinin isimleri (\texttt{J1})
    \end{itemize}

    \pause
    \begin{enumerate}
      \item bütün filmler ve yönetmenleri (\texttt{J1A})

      \pause
      \item \texttt{J1A}'daki film başlıkları ve yönetmen isimleri
         (\texttt{J1})
    \end{enumerate}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Katma Örnekleri - 1}

  \begin{ornek}
    \begin{itemize}
      \item bütün filmler ve yönetmenleri (\texttt{J1A})
    \end{itemize}

    \begin{lstlisting}
MOVIE JOIN
  (PERSON RENAME (PERSON# AS DIRECTOR#))
    \end{lstlisting}

    \pause
    \vspace{-10pt}
    \begin{tiny}
    \begin{table}
      \caption{J1A}
      \begin{tabular}{|r|l|c|r|l|}\hline
\underline{MOVIE\#} & TITLE & ... & DIRECTOR\# & NAME            \\[2pt]\hline\hline
   6 & Usual Suspects       & ... &     639  & Bryan Singer    \\\hline
  70 & Being John Malkovich & ... &      1485  & Spike Jonze     \\\hline
 107 & Batman \& Robin      & ... &       105  & Joel Schumacher \\\hline
 ... & ...                  & ... &       ...  & ...             \\\hline
1468 & Europa               & ... &       615  & Lars von Trier  \\\hline
1512 & Suspiria             & ... &      2259  & Dario Argento   \\\hline
1539 & Cry-Baby             & ... &       364  & John Waters     \\\hline
      \end{tabular}
    \end{table}
    \end{tiny}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Katma Örnekleri - 1}

  \begin{ornek}
    \begin{itemize}
      \item \texttt{J1A}'daki film başlıkları ve yönetmen isimleri
         (\texttt{J1})
    \end{itemize}

    \begin{lstlisting}
J1A { TITLE, NAME }
    \end{lstlisting}

    \pause
    \vspace{-10pt}
    \begin{tiny}
    \begin{table}
      \caption{J1}
      \begin{tabular}{|l|l|}\hline
\underline{TITLE}    & \underline{NAME}\\[2pt]\hline\hline
Batman \& Robin      & Joel Schumacher \\\hline
Being John Malkovich & Spike Jonze     \\\hline
Blade                & Stephen Norrington\\\hline
...                  & ...             \\\hline
Three Kings          & Spike Jonze     \\\hline
Usual Suspects       & Bryan Singer    \\\hline
eXistenZ             & David Cronenberg\\\hline
      \end{tabular}
    \end{table}
    \end{tiny}
  \end{ornek}
\end{frame}

\begin{frame}
  \frametitle{Katma Örnekleri - 2}

  \begin{ornek}
    \begin{itemize}
      \item bütün filmlerin başlıkları, oyuncularının isimleri ve sıraları
        (\texttt{J2})
    \end{itemize}

    \pause
    \begin{enumerate}
      \item bütün filmler ve oyunculuk verileri (\texttt{J2A})

      \pause
      \item \texttt{J2A}'daki bütün verilerin kişilerle eşlenmesi (\texttt{J2B})

      \pause
      \item \texttt{J2B}'deki film başlıkları, oyuncu isimleri ve sıraları
	(\texttt{J2})
    \end{enumerate}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Katma Örnekleri - 2}

  \begin{ornek}
    \begin{itemize}
      \item bütün filmler ve oyunculuk verileri (\texttt{J2A})
    \end{itemize}

    \begin{lstlisting}
MOVIE JOIN CASTING
    \end{lstlisting}

    \pause
    \vspace{-10pt}
    \begin{tiny}
    \begin{table}
      \caption{J2A}
      \begin{tabular}{|r|l|c|r|r|}\hline
\underline{MOVIE\#} & TITLE & ... & \underline{ACTOR\#} & ORD\\[2pt]\hline\hline
   6 & Usual Suspects       & ... &                 302 &   3\\\hline
   6 & Usual Suspects       & ... &                 308 &   2\\\hline
  70 & Being John Malkovich & ... &                 282 &   2\\\hline
  70 & Being John Malkovich & ... &                 503 &  14\\\hline
 ... & ...                  & ... &                 ... & ...\\\hline
1539 & Cry-Baby             & ... &                  26 &   1\\\hline
1539 & Cry-Baby             & ... &                1641 &   5\\\hline
1539 & Cry-Baby             & ... &                3578 &   7\\\hline
      \end{tabular}
    \end{table}
    \end{tiny}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Katma Örnekleri - 2}

  \begin{ornek}
    \begin{itemize}
      \item \texttt{J2A}'daki bütün verilerin kişilerle eşlenmesi (\texttt{J2B})
    \end{itemize}

    \begin{lstlisting}
J2A JOIN (PERSON RENAME (PERSON# AS ACTOR#))
    \end{lstlisting}

    \pause
    \vspace{-10pt}
    \begin{tiny}
    \begin{table}
      \caption{J2B}
      \begin{tabular}{|r|l|c|r|r|l|}\hline
\underline{MOVIE\#} & TITLE & ... & \underline{ACTOR\#} & ORD & NAME\\[2pt]\hline\hline
   6 & Usual Suspects       & ... &     302 &   3 & Benicio Del Toro\\\hline
   6 & Usual Suspects       & ... &     308 &   2 & Gabriel Byrne   \\\hline
  70 & Being John Malkovich & ... &     282 &   2 & Cameron Diaz    \\\hline
  70 & Being John Malkovich & ... &     503 &  14 & John Malkovich  \\\hline
 ... & ...                  & ... &     ... & ... & ...             \\\hline
1539 & Cry-Baby             & ... &      26 &   1 & Johnny Depp     \\\hline
1539 & Cry-Baby             & ... &    1641 &   5 & Iggy Pop        \\\hline
1539 & Cry-Baby             & ... &    3578 &   7 & Traci Lords     \\\hline
      \end{tabular}
    \end{table}
    \end{tiny}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Katma Örnekleri - 2}

  \begin{ornek}
    \begin{itemize}
      \item \texttt{J2B}'deki film başlıkları, oyuncu isimleri ve sıraları
        (\texttt{J2})
    \end{itemize}

    \begin{lstlisting}
J2B { TITLE, NAME, ORD }
    \end{lstlisting}

    \pause
    \vspace{-10pt}
    \begin{tiny}
    \begin{table}
      \caption{J2}
      \begin{tabular}{|l|l|r|}\hline
\underline{TITLE}    & \underline{NAME} & \underline{ORD}\\[2pt]\hline\hline
Usual Suspects       & Benicio Del Toro &   3\\\hline
Usual Suspects       & Gabriel Byrne    &   2\\\hline
Being John Malkovich & Cameron Diaz     &   2\\\hline
Being John Malkovich & John Malkovich   &  14\\\hline
...                  & ...              & ...\\\hline
Cry-Baby             & Johnny Depp      &   1\\\hline
Cry-Baby             & Iggy Pop         &   5\\\hline
Cry-Baby             & Traci Lords      &   7\\\hline
      \end{tabular}
    \end{table}
    \end{tiny}
  \end{ornek}
\end{frame}

\begin{frame}
  \frametitle{Katma Örnekleri - 3}

  \begin{ornek}
    \begin{itemize}
      \item Johnny Depp'in filmlerindeki oyuncuların isimleri (\texttt{J3})
    \end{itemize}

    \pause
    \begin{enumerate}
      \item Johnny Depp'in filmlerinin kimlikleri (\texttt{J3A})

      \pause
      \item  \texttt{J3A}'daki filmlerde oynamış oyuncuların kimlikleri
        (\texttt{J3B})

      \pause
      \item \texttt{J3B}'deki oyuncuların isimleri (\texttt{J3})
    \end{enumerate}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Katma Örnekleri - 3}

  \begin{ornek}
    \begin{itemize}
      \item Johnny Depp'in filmlerinin kimlikleri (\texttt{J3A})
    \end{itemize}

    \begin{lstlisting}
(((PERSON RENAME (PERSON# AS ACTOR#))
    JOIN CASTING)
  WHERE (NAME = 'Johnny Depp')) { MOVIE# }
  \end{lstlisting}

    \pause
    \vspace{-10pt}
    \begin{tiny}
    \begin{table}
      \caption{J3A}
      \begin{tabular}{|r|l|r|r|}\hline
\underline{MOVIE\#}\\[2pt]\hline\hline
                110\\\hline
                228\\\hline
                373\\\hline
                573\\\hline
               1539\\\hline
      \end{tabular}
    \end{table}
    \end{tiny}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Katma Örnekleri - 3}

  \begin{ornek}
    \begin{itemize}
      \item  \texttt{J3A}'daki filmlerde oynamış oyuncuların kimlikleri
        (\texttt{J3B})
    \end{itemize}

    \begin{lstlisting}
(J3A JOIN CASTING) { ACTOR# }
    \end{lstlisting}

    \pause
    \vspace{-10pt}
    \begin{tiny}
    \begin{table}
      \caption{J3B}
      \begin{tabular}{|r|}\hline
\underline{ACTOR\#}\\[2pt]\hline\hline
                 26\\\hline
                187\\\hline
                282\\\hline
                302\\\hline
                308\\\hline
                406\\\hline
               1641\\\hline
               3578\\\hline
      \end{tabular}
    \end{table}
    \end{tiny}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Katma Örnekleri - 3}

  \begin{ornek}
    \begin{itemize}
      \item \texttt{J3B}'deki oyuncuların isimleri (\texttt{J3})
    \end{itemize}

    \begin{lstlisting}
((J3B RENAME (ACTOR# AS PERSON#))
    JOIN PERSON) { NAME }
    \end{lstlisting}

    \pause
    \vspace{-10pt}
    \begin{tiny}
    \begin{table}
      \caption{J3}
      \begin{tabular}{|l|}\hline
\underline{NAME} \\[2pt]\hline\hline
Johnny Depp      \\\hline
Christina Ricci  \\\hline
Cameron Diaz     \\\hline
Benicio Del Toro \\\hline
Gabriel Byrne    \\\hline
Patricia Arquette\\\hline
Iggy Pop         \\\hline
Traci Lords      \\\hline
      \end{tabular}
    \end{table}
    \end{tiny}
  \end{ornek}
\end{frame}
% 
% \begin{frame}
%   \frametitle{Katma}
% 
%   \begin{itemize}
%     \item bağıntıların başlıkları ayrıksa ne olur?
%     \item bağıntıların başlıkları aynıysa ne olur?
%   \end{itemize}
% 
%   \pause
%   \begin{ornek}
%     \begin{itemize}
%       \item "\lstinline!P3 JOIN P4!" işleminin sonucu nedir?
%       \item "\lstinline!S1 JOIN P4A!" işleminin sonucu nedir?
%     \end{itemize}
%   \end{ornek}
% \end{frame}

\begin{frame}[fragile]
  \frametitle{Bölme}

  \begin{tanim}
    \alert{bölme}: birinci bağıntıdaki çoklular arasından\\
      ikinci bağıntıdaki bütün çoklularla\\
      bir ara bağıntıda eşleşenleri seçme
  \end{tanim}

  \pause
  \begin{block}{Komut}
    \begin{lstlisting}
relation1 DIVIDEBY relation2
  PER (relation3)
    \end{lstlisting}
  \end{block}
\end{frame}

\begin{frame}
  \frametitle{Bölme Örneği}

  \begin{ornek}
    \begin{itemize}
      \item Johnny Depp ile Christina Ricci'nin birlikte oynadıkları\\
        filmlerin başlıkları (\texttt{V1})
    \end{itemize}

    \pause
    \begin{enumerate}
      \item Johnny Depp ve Christina Ricci'nin kimlikleri (\texttt{V1A})

      \pause
      \item \texttt{V1A}'daki oyuncuların birlikte oynadıkları filmlerin
        kimlikleri\\
        (\texttt{V1B})

      \pause
      \item \texttt{V1B}'deki filmlerin başlıkları (\texttt{V1})
    \end{enumerate}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Bölme Örneği}

  \begin{ornek}
    \begin{itemize}
      \item Johnny Depp ve Christina Ricci'nin kimlikleri (\texttt{V1A})
    \end{itemize}

    \begin{lstlisting}
(PERSON
    WHERE ((NAME = "Johnny Depp")
        OR (NAME = "Christina Ricci")))
  { PERSON# }
    \end{lstlisting}

    \pause
    \vspace{-10pt}
    \begin{tiny}
    \begin{table}
      \caption{V1A}
      \begin{tabular}{|r|}\hline
\underline{PERSON\#}\\[2pt]\hline\hline
                  26\\\hline
                 187\\\hline
      \end{tabular}
    \end{table}
    \end{tiny}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Bölme Örneği}

  \begin{ornek}
    \begin{itemize}
      \item \texttt{V1A}'daki oyuncuların birlikte oynadıkları filmlerin
        kimlikleri\\
        (\texttt{V1B})
    \end{itemize}

    \begin{lstlisting}
(MOVIE { MOVIE# })
    DIVIDEBY (V1A RENAME (PERSON# AS ACTOR#))
      PER (CASTING { MOVIE#, ACTOR# })
    \end{lstlisting}

    \pause
    \vspace{-10pt}
    \begin{tiny}
    \begin{table}
      \caption{V1B}
      \begin{tabular}{|r|}\hline
\underline{MOVIE\#}\\[2pt]\hline\hline
                110\\\hline
                373\\\hline
      \end{tabular}
    \end{table}
    \end{tiny}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Bölme Örneği}

  \begin{ornek}
    \begin{itemize}
      \item \texttt{V1B}'deki filmlerin başlıkları (\texttt{V1})
    \end{itemize}

    \begin{lstlisting}
(V1B JOIN MOVIE) { TITLE }
    \end{lstlisting}

    \pause
    \vspace{-10pt}
    \begin{tiny}
    \begin{table}
      \caption{V1}
      \begin{tabular}{|l|}\hline
\underline{TITLE}             \\[2pt]\hline\hline
Fear and Loathing in Las Vegas\\\hline
Sleepy Hollow                 \\\hline
      \end{tabular}
    \end{table}
    \end{tiny}
  \end{ornek}
\end{frame}
% 
% \begin{frame}[fragile]
%   \frametitle{Bölme Örneği}
% 
%   \begin{ornek}[bölme - çarpma ilişkisi]
%     \lstinline!V1B JOIN V1A! $\subseteq$ \lstinline!CASTING { MOVIE#, ACTOR# }!
% 
%     \pause
%     \begin{tiny}
%     \begin{table}
%       \caption{$V1B \times V1A$}
%       \begin{tabular}{|r|r|}\hline
% \underline{MOVIE\#} & \underline{ACTOR\#}\\[2pt]\hline\hline
%                 110 &                  26\\\hline
%                 110 &                 187\\\hline
%                 373 &                  26\\\hline
%                 373 &                 187\\\hline
%       \end{tabular}
%     \end{table}
%     \end{tiny}
%   \end{ornek}
% \end{frame}

\subsection{Küme İşlemleri}

\begin{frame}[fragile]
  \frametitle{Kesişim}

  \begin{tanim}
    \alert{kesişim}: iki bağıntıda da bulunan çokluları seçme
  \end{tanim}

  \pause
  \begin{block}{Komut}
    \begin{lstlisting}
relation1 INTERSECT relation2
    \end{lstlisting}
  \end{block}

  \pause
  \begin{itemize}
    \item çıktı başlığı = relation1 başlığı = relation2 başlığı
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Kesişim Örneği}

  \begin{example}
    \begin{itemize}
      \item oyunculuk yapmış bütün yönetmenlerin isimleri (\texttt{I1})
    \end{itemize}

    \pause
    \begin{enumerate}
      \item oyunculuk yapmış bütün yönetmenlerin kimlikleri (\texttt{I1A})

      \pause
      \item \texttt{I1A}'daki bütün kişilerin isimleri (\texttt{I1})
    \end{enumerate}
  \end{example}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Kesişim Örneği}

  \begin{ornek}
    \begin{itemize}
      \item oyunculuk yapmış bütün yönetmenlerin kimlikleri (\texttt{I1A})
    \end{itemize}

    \begin{lstlisting}
(MOVIE { DIRECTOR# }
      RENAME (DIRECTOR# AS PERSON#))
  INTERSECT
(CASTING { ACTOR# }
      RENAME (ACTOR# AS PERSON#))
    \end{lstlisting}

    \pause
    \vspace{-10pt}
    \begin{tiny}
    \begin{table}
      \caption{I1A}
      \begin{tabular}{|r|}\hline
\underline{PERSON\#}\\[2pt]\hline\hline
                1485\\\hline
      \end{tabular}
    \end{table}
    \end{tiny}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Kesişim Örneği}

  \begin{ornek}
    \begin{itemize}
      \item \texttt{I1A}'daki bütün kişilerin isimleri (\texttt{I1})
    \end{itemize}

    \begin{lstlisting}
(I1A JOIN PERSON) { NAME }
    \end{lstlisting}

    \pause
    \vspace{-10pt}
    \begin{tiny}
    \begin{table}
      \caption{I1}
      \begin{tabular}{|l|}\hline
\underline{NAME}\\[2pt]\hline\hline
Spike Jonze     \\\hline
      \end{tabular}
    \end{table}
    \end{tiny}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Birleşim}

  \begin{tanim}
    \alert{birleşim}: iki bağıntıdan en az birinde bulunan çokluları seçme
  \end{tanim}

  \pause
  \begin{block}{Komut}
    \begin{lstlisting}
relation1 UNION relation2
    \end{lstlisting}
  \end{block}

  \pause
  \begin{itemize}
    \item çıktı başlığı = relation1 başlığı = relation2 başlığı
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Birleşim Örneği}

  \begin{ornek}
    \begin{itemize}
      \item 1997'den sonra çekilen filmlerin yönetmenlerinin\\
        ve oyuncularının isimleri (\texttt{U1})
    \end{itemize}

    \pause
    \begin{enumerate}
      \item 1997'den sonra çekilen filmlerin kimlikleri\\
        ve yönetmen kimlikleri (\texttt{U1A})

      \pause
      \item \texttt{U1A}'daki filmlerin bütün oyuncularının kimlikleri (\texttt{U1B})

      \pause
      \item \texttt{U1A} ile \texttt{U1B}'den en az birinde bulunan yönetmen\\
        ve oyuncuların kimlikleri (\texttt{U1C})

      \pause
      \item \texttt{U1C}'deki bütün kişilerin isimleri (\texttt{U1})
    \end{enumerate}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Birleşim Örneği}

  \begin{ornek}
    \begin{itemize}
      \item 1997'den sonra çekilen filmlerin kimlikleri\\
        ve yönetmen kimlikleri (\texttt{U1A})
    \end{itemize}

    \begin{lstlisting}
(MOVIE WHERE (YEAR > YEAR(1997)))
  { MOVIE#, DIRECTOR# }
    \end{lstlisting}

    \pause
    \vspace{-10pt}
    \begin{tiny}
    \begin{table}
      \caption{U1A}
      \begin{tabular}{|r|r|}\hline
\underline{MOVIE\#} & DIRECTOR\#\\[2pt]\hline\hline
 70 &       1485\\\hline
110 &        148\\\hline
112 &       1070\\\hline
213 &       2861\\\hline
251 &        103\\\hline
373 &         59\\\hline
432 &       2557\\\hline
433 &         97\\\hline
      \end{tabular}
    \end{table}
    \end{tiny}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Birleşim Örneği}

  \begin{ornek}
    \begin{itemize}
      \item \texttt{U1A}'daki filmlerin bütün oyuncularının kimlikleri (\texttt{U1B})
    \end{itemize}

    \begin{lstlisting}
(U1A JOIN CASTING) { ACTOR# }
    \end{lstlisting}

    \pause
    \vspace{-10pt}
    \begin{columns}[b]
      \column{.5\textwidth}
      \begin{tiny}
      \begin{table}
        \caption{U1B}
        \begin{tabular}{|r|}\hline
\underline{ACTOR\#}\\[2pt]\hline\hline
                  9\\\hline
                 26\\\hline
                138\\\hline
                187\\\hline
                282\\\hline
                302\\\hline
                308\\\hline
        \end{tabular}
      \end{table}
      \end{tiny}

      \column{.5\textwidth}
      \begin{tiny}
      \begin{table}
        \begin{tabular}{|r|}\hline
                350\\\hline
                406\\\hline
                503\\\hline
                745\\\hline
                793\\\hline
               1485\\\hline
               3578\\\hline
        \end{tabular}
      \end{table}
      \end{tiny}
    \end{columns}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Birleşim Örneği}

  \begin{ornek}
    \begin{itemize}
      \item \texttt{U1A} ile \texttt{U1B}'den en az birinde bulunan yönetmen\\
        ve oyuncuların kimlikleri (\texttt{U1C})
    \end{itemize}

    \begin{lstlisting}
(U1A { DIRECTOR# }
      RENAME (DIRECTOR# AS PERSON#))
UNION (U1B RENAME (ACTOR# AS PERSON#))
    \end{lstlisting}

    \pause
    \vspace{-10pt}
    \begin{columns}[b]
      \column{.2\textwidth}
      \begin{tiny}
      \begin{table}
        \caption{U1C}
        \begin{tabular}{|r|}\hline
\underline{PERSON\#}\\[2pt]\hline\hline
                  9\\\hline
                 26\\\hline
                 59\\\hline
                 97\\\hline
                103\\\hline
                138\\\hline
        \end{tabular}
      \end{table}
      \end{tiny}

      \column{.1\textwidth}
      \begin{tiny}
      \begin{table}
        \begin{tabular}{|r|}\hline
                148\\\hline
                187\\\hline
                282\\\hline
                302\\\hline
                308\\\hline
        \end{tabular}
      \end{table}
      \end{tiny}

      \column{.1\textwidth}
      \begin{tiny}
      \begin{table}
        \begin{tabular}{|r|}\hline
                350\\\hline
                406\\\hline
                503\\\hline
                745\\\hline
                793\\\hline
        \end{tabular}
      \end{table}
      \end{tiny}

      \column{.1\textwidth}
      \begin{tiny}
      \begin{table}
        \begin{tabular}{|r|}\hline
               1070\\\hline
               1485\\\hline
               2557\\\hline
               2861\\\hline
               3578\\\hline
        \end{tabular}
      \end{table}
      \end{tiny}
    \end{columns}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Birleşim Örneği}

  \begin{ornek}
    \begin{itemize}
      \item \texttt{U1C}'deki bütün kişilerin isimleri (\texttt{U1})
    \end{itemize}

    \begin{lstlisting}
(U1C JOIN PERSON) { NAME }
    \end{lstlisting}

    \pause
    \vspace{-10pt}
    \begin{columns}[b]
      \column{.2\textwidth}
      \begin{tiny}
      \begin{table}
        \caption{U1}
        \begin{tabular}{|l|}\hline
\underline{NAME}     \\[2pt]\hline\hline
Arnold Schwarzenegger\\\hline
Benicio Del Toro     \\\hline
Cameron Diaz         \\\hline
Christina Ricci      \\\hline
David Cronenberg     \\\hline
David O. Russell     \\\hline
        \end{tabular}
      \end{table}
      \end{tiny}

      \column{.15\textwidth}
      \begin{tiny}
      \begin{table}
        \begin{tabular}{|l|}\hline
Gabriel Byrne        \\\hline
George Clooney       \\\hline
Jennifer Jason Leigh \\\hline
John Malkovich       \\\hline
Johnny Depp          \\\hline
        \end{tabular}
      \end{table}
      \end{tiny}

      \column{.15\textwidth}
      \begin{tiny}
      \begin{table}
        \begin{tabular}{|l|}\hline
Jude Law             \\\hline
Patricia Arquette    \\\hline
Peter Hyams          \\\hline
Rupert Wainwright    \\\hline
Spike Jonze          \\\hline
        \end{tabular}
      \end{table}
      \end{tiny}

      \column{.2\textwidth}
      \begin{tiny}
      \begin{table}
        \begin{tabular}{|l|}\hline
Stephen Norrington   \\\hline
Terry Gilliam        \\\hline
Tim Burton           \\\hline
Traci Lords          \\\hline
Udo Kier             \\\hline
        \end{tabular}
      \end{table}
      \end{tiny}
    \end{columns}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Fark}

  \begin{tanim}
    \alert{fark}: birinci bağıntıda bulunan ama ikincide bulunmayan\\
      çokluları seçme
  \end{tanim}

  \pause
  \begin{block}{Komut}
    \begin{lstlisting}
relation1 MINUS relation2
    \end{lstlisting}
  \end{block}

  \pause
  \begin{itemize}
    \item çıktı başlığı = relation1 başlığı = relation2 başlığı
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Fark Örneği}

  \begin{ornek}[]
    \begin{itemize}
      \item Johnny Depp'in filmlerinde oynamamış oyuncuların isimleri\\
        (\texttt{D1})
    \end{itemize}

    \pause
    \begin{enumerate}
      \item Johnny Depp'in filmlerinde oynamış oyuncuların kimlikleri\\
        (\texttt{J3B})

      \pause
      \item \texttt{J3B}'de olmayan bütün oyuncuların isimleri (\texttt{D1})
    \end{enumerate}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Fark Örneği}

  \begin{ornek}
    \begin{itemize}
      \item \texttt{J3B}'de olmayan bütün oyuncuların isimleri (\texttt{D1})
    \end{itemize}

    \begin{lstlisting}
(((CASTING { ACTOR# } MINUS J3B)
      RENAME (ACTOR# AS PERSON#))
  JOIN PERSON) {NAME}
    \end{lstlisting}

    \pause
    \vspace{-10pt}
    \begin{columns}[b]
      \column{.2\textwidth}
      \begin{tiny}
      \begin{table}
        \caption{D1}
        \begin{tabular}{|l|}\hline
\underline{NAME}     \\[2pt]\hline\hline
Arnold Schwarzenegger\\\hline
George Clooney       \\\hline
Jennifer Jason Leigh \\\hline
John Malkovich       \\\hline
        \end{tabular}
      \end{table}
      \end{tiny}

      \column{.2\textwidth}
      \begin{tiny}
      \begin{table}
        \begin{tabular}{|l|}\hline
Jude Law             \\\hline
Spike Jonze          \\\hline
Udo Kier             \\\hline
Uma Thurman          \\\hline
        \end{tabular}
      \end{table}
      \end{tiny}
    \end{columns}
  \end{ornek}
\end{frame}

\subsection*{Kaynaklar}

\begin{frame}
  \frametitle{Kaynaklar}

  \begin{block}{Okunacak: Date}
    \begin{itemize}
      \item Chapter 7: Relational Algebra
      \begin{itemize}
        \item 7.1. \alert{Introduction}
        \item 7.2. \alert{Closure Revisited}
        \item 7.4. \alert{The Original Algebra: Semantics}
      \end{itemize}
    \end{itemize}
  \end{block}
\end{frame}

\lstset{language=FullSQL}

\section{SQL}

\subsection{Giriş}

\begin{frame}[fragile]
  \frametitle{Basit Sorgulama}

  \begin{block}{Komut}
    \begin{lstlisting}
SELECT [ ALL | DISTINCT ] column_name [, ...]
  FROM table_name
    \end{lstlisting}
  \end{block}

  \pause
  \begin{itemize}
    \item tekrarlı satırlara izin var
    \begin{itemize}
        \item \lstinline!ALL!: tekrarlı satırlar korunsun (varsayılan)
        \item \lstinline!DISTINCT!: tekrarlı satırlar bir taneye indirilsin
    \end{itemize}

    \item \lstinline!*!: bütün sütunlar
  \end{itemize}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Sorgulama Örnekleri}

  \begin{ornek}[bütün filmlerin bütün verileri]
    \begin{lstlisting}
SELECT * FROM MOVIE
    \end{lstlisting}
  \end{ornek}

  \pause
  \begin{ornek}[bütün filmlerin başlıkları ve yılları]
    \begin{lstlisting}
SELECT TITLE, YR FROM MOVIE
    \end{lstlisting}
  \end{ornek}

  \pause
  \begin{ornek}[hangi yıllarda film çekildiği]
    \begin{lstlisting}
SELECT DISTINCT YR FROM MOVIE
    \end{lstlisting}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Sonuçların Sıralanması}

  \begin{block}{Komut}
    \begin{lstlisting}
SELECT [ ALL | DISTINCT ] column_name [, ...]
  FROM table_name
  [ ORDER BY { column_name [ ASC | DESC ] }
      [, ...] ]
    \end{lstlisting}
  \end{block}

  \pause
  \begin{itemize}
    \item sıralama düzeni:
    \begin{itemize}
      \item \lstinline!ASC!: artan sırada (varsayılan)
      \item \lstinline!DESC!: azalan sırada
    \end{itemize}
  \end{itemize}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Sorgulama Örnekleri}

  \begin{ornek}[hangi yıllarda film çekildiği, yıla göre artan sırada]
    \begin{lstlisting}
SELECT DISTINCT YR FROM MOVIE
  ORDER BY YR
    \end{lstlisting}
  \end{ornek}

  \pause
  \begin{ornek}[hangi yıllarda film çekildiği, yıla göre azalan sırada]
    \begin{lstlisting}
SELECT DISTINCT YR FROM MOVIE
  ORDER BY YR DESC
    \end{lstlisting}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Deyimler}

  \begin{block}{Komut}
    \begin{lstlisting}
SELECT [ ALL | DISTINCT ]
  { expression [ AS column_name ] } [, ...]
  FROM table_name
  [ ORDER BY { column_name [ ASC | DESC ] }
      [, ...] ]
    \end{lstlisting}
  \end{block}

  \pause
  \begin{itemize}
    \item oluşan sütuna yeni isim verilebilir
    \item sıralamada sütunun ismi ya da numarası kullanılabilir
  \end{itemize}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Sorgulama Örnekleri}

  \begin{ornek}[bütün filmlerin başlıkları ve toplam puanları]
    \begin{lstlisting}
SELECT TITLE, SCORE * VOTES
  FROM MOVIE
    \end{lstlisting}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Sorgulama Örnekleri}

  \begin{ornek}[bütün filmlerin başlıkları ve toplam puanları,\\
                toplam puana göre azalan sırada]
    \begin{lstlisting}
SELECT TITLE, SCORE * VOTES AS POINTS
  FROM MOVIE
  ORDER BY POINTS DESC
    \end{lstlisting}

    \pause
    \begin{lstlisting}
SELECT TITLE, SCORE * VOTES
  FROM MOVIE
  ORDER BY 2 DESC
    \end{lstlisting}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Satır Seçme}

  \begin{block}{Komut}
    \begin{lstlisting}
SELECT [ ALL | DISTINCT ]
  { expression [ AS column_name ] } [, ...]
  FROM table_name
  [ WHERE condition ]
  [ ORDER BY { column_name [ ASC | DESC ] }
      [, ...] ]
    \end{lstlisting}
  \end{block}

  \pause
  \begin{columns}
    \column{.5\textwidth}
    \begin{itemize}
      \item karşılaştırma işlemleri:\\
        \lstinline!= < > <= >= <>!
    \end{itemize}

    \column{.5\textwidth}
    \begin{itemize}
      \item bağlaçlar:\\
        \lstinline!NOT AND OR!
    \end{itemize}
  \end{columns}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Koşul Deyimleri}

  \begin{itemize}
    \item sütunun boş olup olmadığı:\\
    \begin{lstlisting}
column_name IS { NULL | NOT NULL }
    \end{lstlisting}

    \pause
    \item küme üyeliği:\\
    \begin{lstlisting}
column_name IN (value_set)
    \end{lstlisting}

    \pause
    \item katar karşılaştırması
    \begin{lstlisting}
column_name LIKE pattern
    \end{lstlisting}
    \begin{itemize}
      \item desende \lstinline!%! işareti herhangi bir simge grubu yerine geçer
    \end{itemize}
  \end{itemize}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Sorgulama Örnekleri}

  \begin{ornek}["Citizen Kane" başlıklı filmlerin yılları]
    \begin{lstlisting}
SELECT YR FROM MOVIE
  WHERE (TITLE = 'Citizen Kane')
    \end{lstlisting}
  \end{ornek}

  \pause
  \begin{ornek}[puanı 3'den küçük ve 10'dan fazla oy almış filmlerin\\
                başlıkları]
    \begin{lstlisting}
SELECT TITLE FROM MOVIE
  WHERE ((SCORE < 3) AND (VOTES > 10))
    \end{lstlisting}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Sorgulama Örnekleri}

  \begin{ornek}[yılı belli olmayan filmlerin başlıkları]
    \begin{lstlisting}
SELECT TITLE FROM MOVIE
  WHERE (YR IS NULL)
    \end{lstlisting}
  \end{ornek}

  \pause
  \begin{ornek}[1967, 1954 ve 1988 yıllarında çekilmiş filmlerin\\
                başlıkları ve yılları]
    \begin{lstlisting}
SELECT TITLE, YR FROM MOVIE
  WHERE (YR IN (1967, 1954, 1988))
    \end{lstlisting}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Sorgulama Örnekleri}

  \begin{ornek}["Police Academy" filmlerinin başlıkları ve puanları]
    \begin{lstlisting}
SELECT TITLE, SCORE FROM MOVIE
  WHERE (TITLE LIKE 'Police Academy%')
    \end{lstlisting}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Gruplama}

  \begin{block}{Komut}
    \begin{lstlisting}
SELECT [ ALL | DISTINCT ]
  { expression [ AS column_name ] } [, ...]
  FROM table_name
  [ WHERE condition ]
  [ GROUP BY column_name [, ...] ]
  [ HAVING condition ]
  [ ORDER BY { column_name [ ASC | DESC ] }
      [, ...] ]
    \end{lstlisting}
  \end{block}

  \pause
  \begin{itemize}
    \item seçilen satırlar gruplanabilir
    \item gruplar içinden seçim yapılabilir
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{İşleniş Sırası}

  \begin{itemize}
    \item \lstinline!WHERE! koşulunu sağlayan satırlar seçilir

    \pause
    \item \lstinline!GROUP BY! ile belirtilen sütunlara göre gruplanır
    \begin{itemize}
      \item gruplama yoksa sonuç tek grup kabul edilir
    \end{itemize}

    \pause
    \item \lstinline!HAVING! koşulunu sağlayan gruplar seçilir

    \pause
    \item sütun listesinde verilen deyimler hesaplanır

    \pause
    \item \lstinline!ORDER BY! ile belirtilen sütun listesine göre sıralanır
  \end{itemize}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Grup Değerleri}

  \begin{itemize}
    \item her grup için tek bir değer oluşmalı
    \begin{itemize}
      \item gruplayan sütunun değeri
      \item biriktirme fonksiyonu sonucu
    \end{itemize}

    \pause
    \item biriktirme fonksiyonları:\\
      \lstinline!COUNT SUM AVG MAX MIN!
    \begin{itemize}
      \item parametre olarak sütun adı verilir
      \item boş değerler hesaba katılmaz
    \end{itemize}
  \end{itemize}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Sorgulama Örnekleri}

  \begin{ornek}[puanı 8.5'den büyük filmlerin hangi yıllarda,\\
                kaçar tane çekildiği]
    \begin{lstlisting}
SELECT YR, COUNT(*) FROM MOVIE
  WHERE (SCORE > 8.5)
  GROUP BY YR
    \end{lstlisting}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Sorgulama Örnekleri}

  \begin{ornek}[her yılın en beğenilen filminin puanı,\\
                yıllara göre artan sırada]
    \begin{lstlisting}
SELECT YR, MAX(SCORE) FROM MOVIE
  GROUP BY YR
  ORDER BY YR
    \end{lstlisting}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Sorgulama Örnekleri}

  \begin{ornek}[kullanılan toplam oy sayısı]
    \begin{lstlisting}
SELECT SUM(VOTES) FROM MOVIE
    \end{lstlisting}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Sorgulama Örnekleri}

  \begin{ornek}[40'dan fazla kişinin oy kullandığı\\
                en az 25 filmin olduğu yıllardaki\\
                filmlerin puanlarının ortalamaları,\\
                yıllara göre artan sırada]
\lstinline!SELECT! \uncover<5->{\lstinline!YR, AVG(SCORE)!\\}
~~~~\lstinline!FROM MOVIE!\\
\pause
~~~~\lstinline!WHERE (VOTES > 40)!\\
\pause
~~~~\lstinline!GROUP BY YR!\\
\pause
~~~~\lstinline!HAVING (COUNT(ID) >= 25)!\\
\pause\pause
~~~~\lstinline!ORDER BY YR!
  \end{ornek}
\end{frame}

\subsection{Katma}

\begin{frame}
  \frametitle{Katma}

  \begin{itemize}
    \item katma işlemi \lstinline!WHERE! koşulları yardımıyla yapılabilir
    \begin{itemize}
      \item tablo listesinde katılacak tablolar belirtilir
      \item eş isimli sütunlar için noktalı gösterilim kullanılır
    \end{itemize}

    \pause
    \item işleniş sırası:
    \begin{itemize}
      \item tabloların Kartezyen çarpımı alınır
      \item \lstinline!WHERE! koşulunu sağlayan satırlar seçilir
      \item ...
    \end{itemize}
  \end{itemize}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Sorgulama Örnekleri}

  \begin{ornek}["Star Wars" başlıklı filmlerin yönetmenlerinin isimleri]
    \begin{lstlisting}
SELECT NAME
  FROM MOVIE, PERSON
  WHERE ((DIRECTORID = PERSON.ID)
     AND (TITLE = 'Star Wars'))
    \end{lstlisting}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Sorgulama Örnekleri}

  \begin{ornek}["Alien" başlıklı filmlerde oynayan oyuncuların isimleri]
     \begin{lstlisting}
SELECT NAME
  FROM MOVIE, PERSON, CASTING
  WHERE ((TITLE = 'Alien')
     AND (MOVIEID = MOVIE.ID)
     AND (ACTORID = PERSON.ID))
      \end{lstlisting}
    \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Sorgulama Örnekleri}

  \begin{ornek}["Harrison Ford" isimli oyuncuların oynadığı\\
                filmlerin başlıkları]
    \begin{lstlisting}
SELECT TITLE
  FROM MOVIE, PERSON, CASTING
  WHERE ((NAME = 'Harrison Ford')
     AND (MOVIEID = MOVIE.ID)
     AND (ACTORID = PERSON.ID))
    \end{lstlisting}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Sorgulama Örnekleri}

  \begin{ornek}["Harrison Ford" isimli oyuncuların oynadığı\\
                ama başrol oynamadığı filmlerin başlıkları]
    \begin{lstlisting}
SELECT TITLE
  FROM MOVIE, PERSON, CASTING
  WHERE ((NAME = 'Harrison Ford')
     AND (MOVIEID = MOVIE.ID)
     AND (ACTORID = PERSON.ID)
     AND (ORD > 1))
    \end{lstlisting}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Sorgulama Örnekleri}

  \begin{ornek}[1962 yılında çekilmiş filmlerin başlıkları\\
                ve başrol oyuncularının isimleri]
    \begin{lstlisting}
SELECT TITLE, NAME
  FROM MOVIE, PERSON, CASTING
  WHERE ((YR = 1962)
     AND (MOVIEID = MOVIE.ID)
     AND (ACTORID = PERSON.ID)
     AND (ORD = 1))
    \end{lstlisting}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Tablo Deyimleri}

  \begin{itemize}
    \item katma işlemi bir tablo deyimi olarak yazılabilir:
    \begin{itemize}
      \item çarpma
      \item koşul belirterek
      \item eş isimli sütunlar üzerinden
      \item doğal katma
      \item dış katma
    \end{itemize}
  \end{itemize}

  \begin{block}{Komut}
    \begin{lstlisting}
SELECT ...
  FROM table_expression [ AS table_name ]
  WHERE selection_condition
  ...
    \end{lstlisting}
  \end{block}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Katma Deyimleri}

  \begin{block}{çarpma}
    \begin{lstlisting}
table1_name CROSS JOIN table2_name
    \end{lstlisting}
  \end{block}

  \pause
  \begin{block}{koşul belirterek}
    \begin{lstlisting}
table1_name JOIN table2_name
  ON condition
    \end{lstlisting}
  \end{block}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Sorgulama Örnekleri}

  \begin{ornek}["Star Wars" başlıklı filmlerin yönetmenlerinin isimleri]
    \begin{lstlisting}
SELECT NAME
  FROM MOVIE JOIN PERSON
          ON (DIRECTORID = PERSON.ID)
  WHERE (TITLE = 'Star Wars')
    \end{lstlisting}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Katma Deyimleri}

  \begin{block}{eş isimli sütunlar üzerinden}
    \begin{lstlisting}
table1_name JOIN table2_name
  USING (column_name [, ...])
    \end{lstlisting}
  \end{block}

  \begin{itemize}
    \item tekrarlı sütunlar bir kere alınır
  \end{itemize}

  \pause
  \begin{block}{doğal katma}
    \begin{lstlisting}
table1_name NATURAL JOIN table2_name
    \end{lstlisting}
  \end{block}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Dış Katma}

  \begin{itemize}
    \item "iç" katmada, diğer tablonun hiçbir satırıyla eşleşmeyen\\
      satırlar sonuç kümesine girmez

    \item dış katmada, eşleşmeyen her satır için\\
      diğer tablodan gelen sütunların boş olduğu bir satır eklenir
  \end{itemize}

  \pause
  \begin{block}{Komut}
    \begin{lstlisting}
table1_name [ LEFT | RIGHT | FULL ]
       [ OUTER ] JOIN table2_name
    \end{lstlisting}
  \end{block}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Dış Katma Örnekleri}

  \begin{ornek}[soldan dış katma]
    \begin{columns}[t]
      \column{.5\textwidth}
      \begin{tiny}
      \begin{table}
        \caption{T1}
        \begin{tabular}{|r|l|}\hline
NUM & NAME\\\hline\hline
  1 & a   \\\hline
  2 & b   \\\hline
  3 & c   \\\hline
        \end{tabular}
      \end{table}
      \end{tiny}

      \column{.5\textwidth}
      \begin{tiny}
      \begin{table}
        \caption{T2}
        \begin{tabular}{|r|l|}\hline
NUM & VALUE\\\hline\hline
  1 & xxx  \\\hline
  3 & yyy  \\\hline
  5 & zzz  \\\hline
        \end{tabular}
      \end{table}
      \end{tiny}
    \end{columns}

    \pause
    \begin{center}
      \begin{tiny}
      \begin{table}
        \caption{SELECT * FROM T1 LEFT JOIN T2}
        \begin{tabular}{|r|l|r|l|}\hline
NUM & NAME & NUM & VALUE\\\hline\hline
  1 & a    &   1 & xxx  \\\hline
  2 & b    &     &      \\\hline
  3 & c    &   3 & yyy  \\\hline
        \end{tabular}
      \end{table}
      \end{tiny}
    \end{center}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Dış Katma Örnekleri}

  \begin{ornek}[sağdan dış katma]
    \begin{columns}[t]
      \column{.5\textwidth}
      \begin{tiny}
      \begin{table}
        \caption{T1}
        \begin{tabular}{|r|l|}\hline
NUM & NAME\\\hline\hline
  1 & a   \\\hline
  2 & b   \\\hline
  3 & c   \\\hline
        \end{tabular}
      \end{table}
      \end{tiny}

      \column{.5\textwidth}
      \begin{tiny}
      \begin{table}
        \caption{T2}
        \begin{tabular}{|r|l|}\hline
NUM & VALUE\\\hline\hline
  1 & xxx  \\\hline
  3 & yyy  \\\hline
  5 & zzz  \\\hline
        \end{tabular}
      \end{table}
      \end{tiny}
    \end{columns}

    \pause
    \begin{center}
      \begin{tiny}
      \begin{table}
        \caption{SELECT * FROM T1 RIGHT JOIN T2}
        \begin{tabular}{|r|l|r|l|}\hline
NUM & NAME & NUM & VALUE\\\hline\hline
  1 & a    &   1 & xxx  \\\hline
  3 & c    &   3 & yyy  \\\hline
    &      &   5 & zzz  \\\hline
        \end{tabular}
      \end{table}
      \end{tiny}
    \end{center}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Dış Katma Örnekleri}

  \begin{ornek}[çift taraflı dış katma]
    \begin{columns}[t]
      \column{.5\textwidth}
      \begin{tiny}
      \begin{table}
        \caption{T1}
        \begin{tabular}{|r|l|}\hline
NUM & NAME\\\hline\hline
  1 & a   \\\hline
  2 & b   \\\hline
  3 & c   \\\hline
        \end{tabular}
      \end{table}
      \end{tiny}

      \column{.5\textwidth}
      \begin{tiny}
      \begin{table}
        \caption{T2}
        \begin{tabular}{|r|l|}\hline
NUM & VALUE\\\hline\hline
  1 & xxx  \\\hline
  3 & yyy  \\\hline
  5 & zzz  \\\hline
        \end{tabular}
      \end{table}
      \end{tiny}
    \end{columns}

    \pause
    \begin{center}
      \begin{tiny}
      \begin{table}
        \caption{SELECT * FROM T1 FULL JOIN T2}
        \begin{tabular}{|r|l|r|l|}\hline
NUM & NAME & NUM & VALUE\\\hline\hline
  1 & a    &   1 & xxx  \\\hline
  2 & b    &     &      \\\hline
  3 & c    &   3 & yyy  \\\hline
    &      &   5 & zzz  \\\hline
        \end{tabular}
      \end{table}
      \end{tiny}
    \end{center}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Sorgulama Örnekleri}

  \begin{ornek}[hiçbir oyuncusu bilinmeyen filmlerin başlıkları]
    \begin{lstlisting}
SELECT TITLE
  FROM MOVIE LEFT JOIN CASTING
         ON (MOVIEID = MOVIE.ID)
  WHERE (ACTORID IS NULL)
    \end{lstlisting}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Kendisiyle Katma}

  \begin{itemize}
    \item katılmak istenen sütunlar aynı tablodaysa
    \item deyimde tabloya yeni isim vererek
  \end{itemize}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Sorgulama Örnekleri}

  \begin{ornek}[aynı sayıda oy almış filmlerin başlıkları]
    \lstinline!SELECT M1.TITLE, M2.TITLE!\\
    \lstinline!  FROM MOVIE AS M1, MOVIE AS M2!\\
    \lstinline!  WHERE (M1.VOTES = M2.VOTES)!\\
    \pause
    \lstinline!     AND (M1.ID < M2.ID)!
  \end{ornek}
\end{frame}

\subsection{Altsorgular}

\begin{frame}[fragile]
  \frametitle{Altsorgular}

  \begin{block}{Komut}
    \begin{lstlisting}
SELECT ...
  WHERE expression operator
      [ ALL | ANY ] (subquery)
  ...
    \end{lstlisting}
  \end{block}

  \begin{itemize}
    \item altsorgu sonuçlarının koşul deyiminde kullanılması
    \pause
    \begin{itemize}
      \item altsorgu sonucunun satır ve sütun sayıları uygun olmalı
      \item \lstinline!ALL!: altsorgudan gelen bütün değerler için
      \item \lstinline!ANY!: altsorgudan gelen en az bir değer için
    \end{itemize}
  \end{itemize}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Sorgulama Örnekleri}

  \begin{ornek}["Star Wars" filminden daha yuksek puanlı filmlerin\\
                başlıkları ve puanları, puana göre azalan sırada]
\uncover<3->{
\lstinline!SELECT TITLE, SCORE FROM MOVIE!\\
~~~~\lstinline!WHERE (!
}
\uncover<2->{
\lstinline!SCORE >!\\
~~~~~~~~\lstinline!(!
}
\lstinline!SELECT SCORE FROM MOVIE!\\
~~~~~~~~~~~~~~\lstinline!WHERE (TITLE = 'Star Wars')!
\uncover<2->{
\lstinline!)!\\
}
\uncover<3->{
\lstinline!) ORDER BY SCORE DESC!
}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Sorgulama Örnekleri}

  \begin{ornek}[bütün "Police Academy" filmlerinin toplam oyundan\\
                daha fazla oy almış filmlerin başlıkları]
\uncover<3->{
\lstinline!SELECT TITLE FROM MOVIE!\\
~~~~\lstinline!WHERE (!
}
\uncover<2->{
\lstinline!VOTES >!\\
~~~~~~~~\lstinline!(!
}
\lstinline!SELECT SUM(VOTES) FROM MOVIE!\\
~~~~~~~~~~~~~~\lstinline!WHERE (TITLE LIKE 'Police Academy%')!
\uncover<2->{
\lstinline!)!\\
}
\uncover<3->{
\lstinline!)!
}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Sorgulama Örnekleri}

  \begin{ornek}[bütün "Police Academy" filmlerinin puanlarından\\
                daha düşük puana sahip filmlerin başlıkları]
\uncover<3->{
\lstinline!SELECT TITLE FROM MOVIE!\\
~~~~\lstinline!WHERE (!
}
\uncover<2->{
\lstinline!SCORE < ALL!\\
~~~~~~~~\lstinline!(!
}
\lstinline!SELECT SCORE FROM MOVIE!\\
~~~~~~~~~~~~~~\lstinline!WHERE (TITLE LIKE 'Police Academy%')!
\uncover<2->{
\lstinline!)!\\
}
\uncover<3->{
\lstinline!)!
}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Sorgulama Örnekleri}

  \begin{ornek}[1930 yılından önce çekilmiş herhangi bir filmin aldığından\\
                daha az oy almış filmlerin başlıkları]
\uncover<3->{
\lstinline!SELECT TITLE FROM MOVIE!\\
~~~~\lstinline!WHERE ((YR >= 1930) AND (!
}
\uncover<2->{
\lstinline!VOTES < ANY (!\\
~~~~~~~~\lstinline!(!
}
\lstinline!SELECT VOTES FROM MOVIE!\\
~~~~~~~~~~~~~~\lstinline!WHERE (YR < 1930)!
\uncover<2->{
\lstinline!)!\\
}
\uncover<3->{
\lstinline!))!
}
  \end{ornek}
\end{frame}

\subsection{Küme İşlemleri}

\begin{frame}
  \frametitle{Küme İşlemleri}

  \begin{itemize}
    \item iki altsorgu sonucu üzerinde işlem

    \item bağıntı modelinin temel küme işlemleri:
    \begin{itemize}
      \item kesişim: \lstinline!INTERSECT!
      \item birleşim: \lstinline!UNION!
      \item fark: \lstinline!EXCEPT!
    \end{itemize}

    \pause
    \item sonuç tablolarında tekrarlı satırlar bulunmaz
  \end{itemize}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Sorgulama Örnekleri}

  \begin{ornek}[hem yönetmenlik hem de oyunculuk yapmış olanların sayısı]
\uncover<3->{
\lstinline!SELECT COUNT(*) FROM (!\\
}
\uncover<2->{
~~~~\lstinline!(!
}
\lstinline!SELECT DISTINCT DIRECTORID FROM MOVIE!
\uncover<2->{
\lstinline!)!\\
~~~~\lstinline!INTERSECT!\\
~~~~\lstinline!(!
}
\lstinline!SELECT DISTINCT ACTORID FROM CASTING!
\uncover<2->{
\lstinline!)!\\
}
\uncover<3->{
\lstinline!) AS DIRECTOR_ACTOR!
}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Sorgulama Örnekleri}

  \begin{ornek}[oyunculuk yapmamış yönetmenlerin sayısı]
\uncover<3->{
\lstinline!SELECT COUNT(*) FROM (!\\
}
\uncover<2->{
~~~~\lstinline!(!
}
\lstinline!SELECT DISTINCT DIRECTORID FROM MOVIE!
\uncover<2->{
\lstinline!)!\\
~~~~\lstinline!EXCEPT!\\
~~~~\lstinline!(!
}
\lstinline!SELECT DISTINCT ACTORID FROM CASTING!
\uncover<2->{
\lstinline!)!\\
}
\uncover<3->{
\lstinline!) AS DIRECTOR_ONLY!
}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Sorgulama Örnekleri}

  \begin{ornek}[1930'dan önce çekilmiş filmlerde çalışan kişilerin sayısı]
\uncover<3->{
\lstinline!SELECT COUNT(*) FROM (!\\
}
\uncover<2->{
~~~~\lstinline!(!
}
\lstinline!SELECT DISTINCT DIRECTORID FROM MOVIE!\\
~~~~~~~~~~~\lstinline!WHERE (YR < 1930)!
\uncover<2->{
\lstinline!)!\\
~~~~\lstinline!UNION!\\
~~~~\lstinline!(!
}
\lstinline!SELECT DISTINCT ACTORID FROM CASTING!\\
~~~~~~~~~~~\lstinline!WHERE (MOVIEID IN!\\
~~~~~~~~~~~~~~~~~~~~~~~~\lstinline!( SELECT ID FROM MOVIE!\\
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\lstinline!WHERE (YR < 1930) ))!
\uncover<2->{
\lstinline!)!\\
}
\uncover<3->{
\lstinline!) AS OLD_MOVIE_PERSON_IDS!
}
  \end{ornek}
\end{frame}

\subsection*{Ek Örnekler}

\begin{frame}
  \frametitle{Ek Örnekler}

  \begin{itemize}
    \item John Travolta'nın hangi yıl kaç filmde oynadığı
    \item 1978 yılında çekilmiş filmlerin başlıkları ve oyuncu sayıları,\\
      oyuncu sayısına göre azalan sırada
    \item Johnny Depp ile oynamış oyuncuların isimleri
    \item Uma Thurman'ın oynadığı filmlerin başlıkları\\
      ve başrol oyuncularının isimleri
    \item en az 10 başrol oynamış oyuncuların isimleri
  \end{itemize}
\end{frame}

\mode
<beamer>

\begin{frame}[fragile]
  \frametitle{Ek Sorgulama Örnekleri}

  \begin{ornek}[John Travolta'nın hangi yıl kaç filmde oynadığı]
\lstinline!SELECT! \uncover<4->{\lstinline!YR, COUNT(MOVIEID)!\\}
~~~~\lstinline!FROM MOVIE, PERSON, CASTING!\\
\pause
~~~~\lstinline!WHERE ((NAME = 'John Travolta')!\\
~~~~~~~~~\lstinline!AND (MOVIEID = MOVIE.ID)!\\
~~~~~~~~~\lstinline!AND (ACTORID = PERSON.ID))!\\
\pause
~~~~\lstinline!GROUP BY YR!
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Ek Sorgulama Örnekleri}

  \begin{ornek}[1978 yılında çekilmiş filmlerin başlıkları ve oyuncu sayıları,\\
                oyuncu sayısına göre azalan sırada]
\lstinline!SELECT! \uncover<4->{\lstinline!TITLE, COUNT(ACTORID)!}\\
~~~~\lstinline!FROM MOVIE, CASTING!\\
\pause
~~~~\lstinline!WHERE ((YR = 1978)!\\
~~~~~~~~~\lstinline!AND (MOVIE.ID = CASTING.MOVIEID))!\\
\pause
~~~~\lstinline!GROUP BY MOVIEID, TITLE!\\
\pause\pause
~~~~\lstinline!ORDER BY 2 DESC!
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Ek Sorgulama Örnekleri}

  \begin{ornek}[Johnny Depp ile oynamış oyuncuların isimleri]
\uncover<2->{
\lstinline!SELECT NAME FROM PERSON, CASTING!\\
~~~~\lstinline!WHERE ((ACTORID = PERSON.ID)!\\
~~~~~~~~\lstinline!AND  (MOVIEID IN (!\\
}
~~~~~~~~~~~~~~~~~\lstinline!SELECT MOVIEID!\\
~~~~~~~~~~~~~~~~~~~~~\lstinline!FROM PERSON, CASTING!\\
~~~~~~~~~~~~~~~~~~~~~\lstinline!WHERE ((ACTORID = PERSON.ID)!\\
~~~~~~~~~~~~~~~~~~~~~~~~~~\lstinline!AND (NAME = 'Johnny Depp'))!\\
\uncover<2->{
\lstinline!) ))!
}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Ek Sorgulama Örnekleri}

  \begin{ornek}[Uma Thurman'ın oynadığı filmlerin başlıkları\\
                ve başrol oyuncularının isimleri]
\uncover<2->{
\lstinline!SELECT TITLE, NAME FROM MOVIE, PERSON, CASTING!\\
~~~~\lstinline!WHERE ((MOVIEID = MOVIE.ID)!\\
~~~~~~~~~~\lstinline!AND (ACTORID = PERSON.ID)!\\
~~~~~~~~~~\lstinline!AND (ORD = 1)!\\
~~~~~~~~~~\lstinline!AND (MOVIEID IN! (\\
}
~~~~~~~~~~~~~~~~~\lstinline!SELECT MOVIEID!\\
~~~~~~~~~~~~~~~~~~~~~\lstinline!FROM PERSON, CASTING!\\
~~~~~~~~~~~~~~~~~~~~~\lstinline!WHERE ((ACTORID = PERSON.ID)!\\
~~~~~~~~~~~~~~~~~~~~~~~~~~\lstinline!AND (NAME = 'Uma Thurman'))!\\
\uncover<2->{
\lstinline!) ))!
}
  \end{ornek}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Ek Sorgulama Örnekleri}

  \begin{ornek}[en az 10 başrol oynamış oyuncuların isimleri]
\uncover<4->{
\lstinline!SELECT NAME FROM PERSON!\\
~~~~\lstinline!WHERE (ID IN (!\\
}
~~~~~~~~~~~~\lstinline!SELECT ACTORID FROM CASTING!\\
~~~~~~~~~~~~~~~~\lstinline!WHERE (ORD = 1)!\\
\pause
~~~~~~~~~~~~~~~~\lstinline!GROUP BY ACTORID!\\
\pause
~~~~~~~~~~~~~~~~\lstinline!HAVING (COUNT(MOVIEID) >= 10)!\\
\uncover<4->{
\lstinline!) )!
}
  \end{ornek}
\end{frame}

\mode
<all>

\subsection*{Kaynaklar}

\begin{frame}
  \frametitle{Kaynaklar}

  \begin{block}{Okunacak: Date}
    \begin{itemize}
      \item Chapter 8: Relational Calculus
      \begin{itemize}
        \item 8.6. \alert{SQL Facilities}
      \end{itemize}
      \item Appendix B: \alert{SQL Expressions}
      \item Chapter 19: Missing Information
    \end{itemize}
  \end{block}

  \begin{block}{Yardımcı Kaynak}
    \begin{itemize}
      \item A Gentle Introduction to SQL:\\
	\url{http://sqlzoo.net/}
    \end{itemize}
  \end{block}
\end{frame}

\end{document}
